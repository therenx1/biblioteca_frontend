<div *ngIf="cargando" class="text-center py-5">
  <div class="spinner-border text-primary"></div>
  <p class="mt-2 text-muted">Cargando detalle del préstamo...</p>
</div>

<div class="container" *ngIf="!cargando && prestamo">
  <div class="containerGeneral">
    <main class="form-container">

      <h2 class="form-title text-center mb-4">
        <i class="bi bi-journal-bookmark-fill"></i>
        Detalle del Préstamo de Libro
      </h2>

      <div class="d-flex justify-content-end mb-3 gap-2">
        <button class="btn btn-secondary btn-sm" (click)="imprimir()">
          <i class="bi bi-printer"></i> Imprimir
        </button>

        <button class="btn btn-danger btn-sm" (click)="generarPDF()">
          <i class="bi bi-filetype-pdf"></i> Exportar PDF
        </button>
      </div>

      <div class="section-title">
        <i class="bi bi-person-circle"></i> Datos del Usuario
      </div>

      <div class="row g-3">
        <div class="col-md-4">
          <label>Código</label>
          <input class="form-control form-control-sm" [value]="prestamo.id_prestamos" readonly>
        </div>

        <div class="col-md-4">
          <label>Nombre</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.usuario?.nombre_usuario" readonly>
        </div>

        <div class="col-md-4">
          <label>Apellido</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.usuario?.apellido_usuario" readonly>
        </div>

        <div class="col-md-4">
          <label>DNI</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.usuario?.dni" readonly>
        </div>

        <div class="col-md-4">
          <label>Correo</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.usuario?.correo" readonly>
        </div>

        <div class="col-md-4">
          <label>Teléfono</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.usuario?.telefono" readonly>
        </div>

        <div class="col-md-4">
          <label>Dirección</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.usuario?.direccion" readonly>
        </div>

        <div class="col-md-4">
          <label>Género</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.usuario?.genero" readonly>
        </div>

        <div class="col-md-4">
          <label>Fecha Nacimiento</label>
          <input type="date" class="form-control form-control-sm"
            [value]="prestamo.usuario?.fecha_nacimiento" readonly>
        </div>
      </div>

      <div class="section-title mt-4">
        <i class="bi bi-book-half"></i> Información del Libro
      </div>

      <div class="row g-3">
        <div class="col-md-4">
          <label>Título</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.libros?.titulo" readonly>
        </div>

        <div class="col-md-4">
          <label>Año</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.libros?.anio" readonly>
        </div>

        <div class="col-md-4">
          <label>ISBN</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.libros?.isbn" readonly>
        </div>

        <div class="col-md-4">
          <label>Editorial</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.libros?.editorial" readonly>
        </div>

        <div class="col-md-4">
          <label>Autor</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.libros?.autores?.nombreAutores" readonly>
        </div>

        <div class="col-md-4">
          <label>Nacionalidad</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.libros?.autores?.nacionalidad" readonly>
        </div>

        <div class="col-md-4">
          <label>Categoría</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.libros?.categoria?.nombreCategoria" readonly>
        </div>
      </div>


      <div class="section-title mt-4">
        <i class="bi bi-clock-history"></i> Detalle del Préstamo
      </div>

      <div class="row g-3">
        <div class="col-md-4">
          <label>Fecha Préstamo</label>
          <input type="date" class="form-control form-control-sm"
            [value]="prestamo.fecha_prestamo" readonly>
        </div>

        <div class="col-md-4">
          <label>Fecha Devolución</label>
          <input type="date" class="form-control form-control-sm"
            [value]="prestamo.fecha_devolucion" readonly>
        </div>

        <div class="col-md-4">
          <label>Fecha Real</label>
          <input type="date" class="form-control form-control-sm"
            [value]="prestamo.fecha_real" readonly>
        </div>

        <div class="col-md-4">
          <label>Multa</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.multa" readonly>
        </div>

        <div class="col-md-4">
          <label>Estado del Libro</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.estadoLibro?.descripcion" readonly>
        </div>

        <div class="col-md-8">
          <label>Comentarios</label>
          <input class="form-control form-control-sm"
            [value]="prestamo.comentarios" readonly>
        </div>
      </div>
      <div class="d-flex justify-content-end mt-4">
        <a routerLink="/listadoPrestamos" class="btn btn-outline-primary btn-sm">
          <i class="bi bi-arrow-left-circle"></i> Volver
        </a>
      </div>

    </main>
  </div>
</div>
